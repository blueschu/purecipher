# Python API to purecipher

This extension module provides python bindings to the Rust purecipher library.

## Dependencies 
Building this extension requires the Python development headers, a recent Rust 
installation that includes `cargo`, a C11 compatible compiler, and Python3 
setuptools. CMake may be used at your option to simplify the build process.

Some conventions used in this extension, such as the use of booleans and 
fixed-width integers, are only explicitly supported in Python version greater 
than or equal to 3.6. See [PEP 7][PEP7] for more details.

Please note that while this extension is dependent on purecipher, the purecipher
dynamic library is not included in the python package distribtion generated by
`setup.py`. In order to use this extension, you must either install the 
purecipher library to a location on system where your loader can find it or
temporarily add Cargo's output directory to your library search path.

On Linux, you can either copy the `libpurecipher.so` file built by Cargo to your 
`/usr/local/lib/` directory, or set the `LD_LIBRARY_PATH` environment variable to 
Cargo's output directory. Relative to this file, Cargo's outputs its targets 
to `../../target/{debug,release}`.

While I have not yet tested installing this extension on Windows, you should 
be able to simply install the `.dll` file produced by Cargo to have the same
effect.

## Building
All commands are given relative to this repository's root, NOT relative to this file.

With CMake:
```bash
$ mkdir -p cmake-build-debug
$ cd !$
$ cmake -DCMAKE_BUILD_TYPE=Debug ..
$ make purecipher-python
```
The extension module will be located in `cmake-build-debug/wrappers/python`.

Manually:
```bash
$ cargo build --release
$ cd wrappers/python
$ python3 setup.py build
```
The extension module will be located in `wrappers/python/build/lib.{SYSTEM-SPECIFIC-SUFFIX}`.

## Usage
To use this extension module, run python in the directory containing the module
or add it to your `PYTHONPATH` environment variable. Then, simply import the
module from python with `import purecipher`. If you receive an error similar to
`ImportError: libpurecipher.so: cannot open shared object file: No such file or directory`,
make sure that the purecipher library is accessible to your system's loader. See
the "Dependencies" above section for more details.

## Testing
Since the unitests are not located in the same direcotry as the module file, 
you will need to either add the module's directory to the `PYTHONPATH` 
environment variable, or use setuptools `develop` command to temporary add egg
link to the module in your python installation as shown below. Make sure that
the purecipher library itself is accessible, either by installing to your
systems library path or setting `LD_LIBRARY_PATH` to `../../target/release` if
you're using Linux.
```bash
$ python3 setup.py develop  # install egg links in your python path
$ python3 -m unittest test.purecipher_test
$ python3 setup.py develop --uninstall  # remove links, restoring your python installation
```

## Copyright & License
Copyright &copy; 2018 Brian Schubert - available under [MIT License][license].

[PEP7]: https://www.python.org/dev/peps/pep-0007/
[license]: ./LICENSE
